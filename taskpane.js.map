{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js"],"sourcesContent":["(() => {\n  // URL complète de la page d'auth (évite les soucis avec window.location.origin)\n  const AUTH_PAGE = \"https://art-errorless-roseann.ngrok-free.dev/auth.html\";\n  let accessToken = null;\n\n  function log(msg) {\n    console.log(\"[Add-in]\", msg);\n  }\n\n  async function openAuthDialog() {\n    return new Promise((resolve, reject) => {\n      log(\"Ouverture du dialogue d'auth...\");\n      Office.context.ui.displayDialogAsync(\n        AUTH_PAGE,\n        { height: 60, width: 40, displayInIframe: false },\n        (asyncResult) => {\n          if (asyncResult.status === Office.AsyncResultStatus.Failed) {\n            return reject(new Error(\"Impossible d'ouvrir la fenêtre d'auth\"));\n          }\n\n          const dialog = asyncResult.value;\n\n          dialog.addEventHandler(Office.EventType.DialogMessageReceived, (arg) => {\n            try {\n              const payload = JSON.parse(arg.message);\n              if (payload.accessToken) {\n                resolve(payload.accessToken);\n              } else {\n                reject(new Error(payload.error || \"Message inattendu depuis auth.html\"));\n              }\n            } catch (e) {\n              reject(e);\n            } finally {\n              try { dialog.close(); } catch {}\n            }\n          });\n\n          dialog.addEventHandler(Office.EventType.DialogEventReceived, (event) => {\n            reject(new Error(\"Fenêtre d'auth fermée/annulée: \" + JSON.stringify(event)));\n            try { dialog.close(); } catch {}\n          });\n        }\n      );\n    });\n  }\n\n  async function getRecipientsAsync() {\n    return new Promise((resolve, reject) => {\n      Office.context.mailbox.item.to.getAsync((result) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          const recipients = (result.value || [])\n            .map(r => (typeof r === \"string\" ? r : (r.emailAddress || r.address)))\n            .filter(Boolean);\n          resolve(recipients);\n        } else {\n          reject(result.error || new Error(\"Impossible de lire les destinataires\"));\n        }\n      });\n    });\n  }\n  async function getSubjectAsync() {\n  return new Promise((resolve, reject) => {\n    Office.context.mailbox.item.subject.getAsync((result) => {\n      if (result.status === Office.AsyncResultStatus.Succeeded) {\n        resolve(result.value || \"(Sans sujet)\");\n      } else {\n        reject(result.error || new Error(\"Impossible de lire le sujet du mail\"));\n      }\n    });\n  });\n}\n  async function getBodyHtmlAsync() {\n    return new Promise((resolve, reject) => {\n      Office.context.mailbox.item.body.getAsync(\"html\", (result) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          resolve(result.value || \"\");\n        } else {\n          reject(result.error || new Error(\"Impossible de lire le corps\"));\n        }\n      });\n    });\n  }\n\n  async function getAttachmentsFromDraft(itemId, token) {\n  if (!itemId) return [];\n\n  // Convertir en REST ID v2.0 pour Graph\n  const restId = Office.context.mailbox.convertToRestId(\n    itemId,\n    Office.MailboxEnums.RestVersion.v2_0\n  );\n\n  const res = await fetch(`https://graph.microsoft.com/v1.0/me/messages/${restId}/attachments`, {\n    method: \"GET\",\n    headers: {\n      \"Authorization\": `Bearer ${token}`,\n      \"Content-Type\": \"application/json\"\n    }\n  });\n\n  if (!res.ok) {\n    const txt = await res.text().catch(() => \"\");\n    throw new Error(`Graph error ${res.status}: ${txt}`);\n  }\n\n  const data = await res.json();\n  return (data.value || [])\n    .filter(att => att[\"@odata.type\"] === \"#microsoft.graph.fileAttachment\")\n    .map(att => ({\n      name: att.name,\n      contentBytes: att.contentBytes,\n      contentType: att.contentType || \"application/octet-stream\"\n    }));\n}\n\nasync function sendEmail(token, to, subject, bodyHtml, attachments = []) {\n  const mail = {\n    message: {\n      subject: subject || \"(Sans sujet)\",\n      body: { contentType: \"HTML\", content: bodyHtml || \"\" },\n      toRecipients: [{ emailAddress: { address: to } }],\n      attachments: attachments.map(att => ({\n        \"@odata.type\": \"#microsoft.graph.fileAttachment\",\n        name: att.name,\n        contentBytes: att.contentBytes,\n        contentType: att.contentType || \"application/octet-stream\"\n      }))\n    }\n  };\n\n  const res = await fetch(\"https://graph.microsoft.com/v1.0/me/sendMail\", {\n    method: \"POST\",\n    headers: {\n      \"Authorization\": `Bearer ${token}`,\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(mail)\n  });\n\n  if (!res.ok) {\n    const txt = await res.text().catch(() => \"\");\n    throw new Error(`Graph error ${res.status}: ${txt}`);\n  }\n}\n\n// Sauvegarde le mail courant et retourne son itemId\nasync function saveDraftIfNeeded() {\n  return new Promise((resolve, reject) => {\n    Office.context.mailbox.item.saveAsync((result) => {\n      if (result.status === Office.AsyncResultStatus.Succeeded) {\n        resolve(result.value); // ID du draft Outlook\n      } else {\n        reject(result.error || new Error(\"Impossible de sauvegarder le draft\"));\n      }\n    });\n  });\n}\n\n// Supprime le draft via Microsoft Graph\nasync function deleteDraft(itemId, accessToken) {\n  if (!itemId) return; // sécurité\n  // Convertir l'ID Outlook en ID REST pour Graph\n  const restId = Office.context.mailbox.convertToRestId(itemId, Office.MailboxEnums.RestVersion.v2_0);\n\n  const res = await fetch(`https://graph.microsoft.com/v1.0/me/messages/${restId}`, {\n    method: \"DELETE\",\n    headers: {\n      \"Authorization\": `Bearer ${accessToken}`\n    }\n  });\n\n  if (!res.ok) {\n    const txt = await res.text().catch(() => \"\");\n    console.error(\"Erreur suppression draft:\", txt);\n  } else {\n    console.log(\"Draft supprimé avec succès\");\n  }\n}\n\n\n  async function run() {\n    try {\n      log(\"Démarrage de l'action...\");\n      // Sauvegarde le mail en draft\n      let draftId = null;\n      try {\n        draftId = await saveDraftIfNeeded();\n        console.log(\"Draft sauvegardé, ID =\", draftId);\n      } catch (err) {\n        console.warn(\"Impossible de sauvegarder le draft :\", err);\n      }\n\n      if (!accessToken) {\n        log(\"Pas de token — ouverture auth...\");\n        accessToken = await openAuthDialog();\n      }\n\n      if (!accessToken) throw new Error(\"Token introuvable après auth\");\n\n      const recipients = await getRecipientsAsync();\n      if (!recipients || recipients.length === 0) {\n        Office.context.mailbox.item.notificationMessages.replaceAsync(\"noRecipients\", {\n          type: \"errorMessage\",\n          message: \"⚠️ Aucun destinataire trouvé.\"\n        });\n        return;\n      }\n\n      const subject = await getSubjectAsync();\n      const bodyHtml = await getBodyHtmlAsync();\n      let attachments = [];\n      if (draftId) {\n        try {\n          attachments = await getAttachmentsFromDraft(draftId, accessToken);\n          console.log(`📎 ${attachments.length} pièce(s) jointe(s) récupérée(s)`);\n        } catch (err) {\n          console.warn(\"Impossible de récupérer les pièces jointes :\", err);\n        }\n      }\n      let sent = 0;\n\n      for (const to of recipients) {\n        try {\n          log(`Envoi à ${to}...`);\n          await sendEmail(accessToken, to, subject, bodyHtml, attachments);\n          sent++;\n        } catch (err) {\n          console.error(\"Erreur envoi:\", err);\n          log(`Erreur envoi ${to}: ${err.message || err}`);\n        }\n      }\n      if (draftId && sent === recipients.length) {\n        await deleteDraft(draftId, accessToken);\n      }\n\n      Office.context.mailbox.item.notificationMessages.replaceAsync(\"successMsg\", {\n        type: \"informationalMessage\",\n        message: `✅ ${sent} email(s) envoyés individuellement`,\n        icon: \"icon16\",\n        persistent: false\n      });\n      log(\"Terminé.\");\n    } catch (err) {\n      console.error(\"Erreur run:\", err);\n      Office.context.mailbox.item.notificationMessages.replaceAsync(\"errorMsg\", {\n        type: \"errorMessage\",\n        message: \"❌ Une erreur est survenue. Voir console.\"\n      });\n    }\n  }\n\n  // Attendre que Office.js soit prêt avant de lier l’action\n  Office.onReady(() => {\n    Office.actions.associate(\"run\", run);\n  });\n})();"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","accessToken","log","msg","console","openAuthDialog","_openAuthDialog","_callee","_context","reject","Office","context","ui","displayDialogAsync","height","width","displayInIframe","asyncResult","status","AsyncResultStatus","Failed","Error","dialog","addEventHandler","EventType","DialogMessageReceived","arg","payload","JSON","parse","message","error","close","_unused","DialogEventReceived","event","stringify","_unused2","getRecipientsAsync","_getRecipientsAsync","_callee2","_context2","mailbox","item","to","getAsync","result","Succeeded","recipients","map","emailAddress","address","filter","Boolean","getSubjectAsync","_getSubjectAsync","_callee3","_context3","subject","getBodyHtmlAsync","_getBodyHtmlAsync","_callee4","_context4","body","getAttachmentsFromDraft","_x","_x2","_getAttachmentsFromDraft","_callee5","itemId","token","restId","res","txt","data","_context5","convertToRestId","MailboxEnums","RestVersion","v2_0","fetch","concat","method","headers","ok","text","catch","json","att","name","contentBytes","contentType","sendEmail","_x3","_x4","_x5","_x6","_sendEmail","_callee6","bodyHtml","mail","_args6","_context6","content","toRecipients","attachments","undefined","saveDraftIfNeeded","_saveDraftIfNeeded","_callee7","_context7","saveAsync","deleteDraft","_x7","_x8","_deleteDraft","_callee8","_context8","run","_run","_callee9","draftId","sent","_iterator","_step","_t","_t2","_t3","_t4","_t5","_context9","warn","notificationMessages","replaceAsync","type","_createForOfIteratorHelper","s","icon","persistent","onReady","actions","associate"],"sourceRoot":""}